# name: test/sql/function/string/parse_path.test
# description: parse path functions test
# group: [string]

statement ok
PRAGMA enable_verification

# TODO: test also windows
query T
SELECT parse_path('home/user/documents/file.csv', 'system');
----
[home, user, documents, file.csv]

query T
SELECT parse_path('home/user/documents/file.csv', 'both_slash');
----
[home, user, documents, file.csv]

query T
SELECT parse_path('C:\Users\User\Documents\File.csv', 'both_slash');
----
[C:, Users, User, Documents, File.csv]

query T
SELECT parse_path('/home/user/documents/file.csv', 'forward_slash');
----
[, home, user, documents, file.csv]

query T
SELECT parse_path('C:\Users\User\Documents\File.csv', 'backslash');
----
[C:, Users, User, Documents, File.csv]

# no seperator in path
query T
SELECT parse_path('file.csv', 'backslash');
----
[file.csv]

# consecutive separators 
query T
SELECT parse_path('home/user/documents//file.csv', 'forward_slash');
----
[home, user, documents, , file.csv]

# special characters
query T
SELECT parse_path('home\wh@t3ve%\42/12 ch,ars.sth', 'both_slash');
----
[home, wh@t3ve%, 42, 12 ch,ars.sth]

query T
SELECT parse_path('', 'both_slash');
----
[]

query T
SELECT parse_path(NULL, NULL);
----
NULL

# custom seperator
query T
SELECT parse_path('home/user/documents/file.csv','@');
----
[home, user, documents, file.csv]

# test incorrect usage
statement error
SELECT parse_path();
----

statement error
SELECT parse_path('home/user/documents/file.csv');
----


# test parse_dirname
query T
SELECT parse_dirname('home/user/documents/file.csv', 'system');
----
home

query T
SELECT parse_dirname('home/user/documents/file.csv', 'both_slash');
----
home

query T
SELECT parse_dirname('home/user/documents/file.csv', 'forward_slash');
----
home

query T
SELECT parse_dirname('C:\Users\User\Documents\File.csv', 'backslash');
----
C:

# no separator
query T
SELECT parse_dirname('file.csv', 'both_slash');
----
file.csv

query T
SELECT parse_dirname('\home\docs', 'both_slash');
----
(empty)

query T
SELECT parse_dirname('home/user/documents/file.csv','@');
----
home

# test incorrect usage
statement error
SELECT parse_dirname('file.csv');
----

# parse path with special characters
query T
SELECT parse_dirname('wh@t3ve%\42\12 ch,ars.sth', 'both_slash');
----
wh@t3ve%


# test parse_filename
query T
SELECT parse_filename('home/user/documents/file.csv', 'system');
----
file.csv

query T
SELECT parse_filename('home/user/documents/file.csv', 'both_slash');
----
file.csv

query T
SELECT parse_filename('C:\Users\User\Documents\File.csv', 'both_slash');
----
File.csv

query T
SELECT parse_filename('home/user/documents/file.csv', 'forward_slash');
----
file.csv

query T
SELECT parse_filename('C:\Users\User\Documents\File.csv', 'backslash');
----
File.csv

# no separator
query T
SELECT parse_filename('file.csv', 'both_slash');
----
file.csv

query T
SELECT parse_filename('home\docs\', 'both_slash');
----
(empty)

query T
SELECT parse_filename('home/user/documents/file.csv','@');
----
file.csv

# test incorrect usage
statement error
SELECT parse_filename('file.csv');
----

# parse path with special characters
query T
SELECT parse_filename('wh@t3ve%\42\12 ch,ars.sth', 'both_slash');
----
12 ch,ars.sth

query T
SELECT parse_filename('', 'both_slash');
----
(empty)
